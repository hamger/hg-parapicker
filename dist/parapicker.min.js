(function(d,f){"object"===typeof exports&&"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define(f):d.ParaPicker=f()})(this,function(){function d(a){return document.getElementById(a)}function f(a,b,c){a=a.children;for(var d=0;d<a.length;d++)a[d].style[b]=c}function g(a){this.inputId=a.inputId;this.data=a.data;this.valueKey=a.valueKey||"value";this.childKey=a.childKey||"child";this.beforeShow=a.beforeShow||null;this.success=a.success;this.cancel=a.cancel||null;this.title=a.title||"";this.sureText=a.sureText||"\u786e\u5b9a";this.cancelText=a.cancelText||"\u53d6\u6d88";this.a=a.a||.001;this.style=a.style;this.initTab();this.initUI();this.initEvent()}g.prototype={constructor:g,initTab:function(){this.input=d(this.inputId);this.wrapId=this.inputId+"-wrap";this.paraIndex=[];this.ulCount=this.data.length;this.liNum=[];for(var a=0;a<this.ulCount;a++)this.liNum[a]=this.data[a].length;this.liHeight=this.style&&this.style.liHeight?this.style.liHeight:40;this.btnHeight=this.style&&this.style.btnHeight?this.style.btnHeight:44;this.paraUl=[];this.curDis=[];this.curPos=[];this.moveTime=this.moveY=this.endTime=this.startTime=this.startY=0;this.moveNumber=1;this.moveSpeed=[];this.abled=!0;this.container=this.wrapId+"-container";this.box=this.wrapId+"-box";this.content=this.wrapId+"-content";this.abolish=this.wrapId+"-abolish";this.sure=this.wrapId+"-sure"},initUI:function(){this.createContainer();this.renderContent()},initEvent:function(){var a=this,b=a.wrap,c=d(a.container);d(a.inputId).addEventListener("click",function(){a.beforeShow()||a.show(b,c)});d(a.sure).addEventListener("click",function(){a.success(a.getResult());a.hide(b,c)});d(a.abolish).addEventListener("click",function(){a.cancel&&a.cancel();a.hide(b,c)});b.addEventListener("click",function(d){d.target.id===a.wrapId&&(a.cancel&&a.cancel(),a.hide(b,c))})},createContainer:function(){var a=document.createElement("div");a.id=this.wrapId;document.body.appendChild(a);this.wrap=d(this.wrapId);this.wrap.classList.add("hg-picker-bg")},getValue:function(a){for(var b=[],c=0;c<a.length;c++)"object"===typeof a[c]?b.push(a[c][this.valueKey]):b.push(a[c]);return b},renderContent:function(){this.wrap.innerHTML=this.style&&"bottom"===this.style.btnLocation?'<div  class="hg-picker-container" id="'+this.container+'"><div class="hg-picker-content" id="'+this.content+'"><div class="hg-picker-up-shadow"></div><div class="hg-picker-down-shadow"></div><div class="hg-picker-line"></div></div><div class="hg-picker-btn-box" id="'+this.box+'">'+this.title+'<div class="hg-picker-btn" id="'+this.abolish+'">'+this.cancelText+'</div><div class="hg-picker-btn" id="'+this.sure+'">'+this.sureText+"</div></div></div>":'<div  class="hg-picker-container" id="'+this.container+'"><div class="hg-picker-btn-box" id="'+this.box+'">'+this.title+'<div class="hg-picker-btn" id="'+this.abolish+'">'+this.cancelText+'</div><div class="hg-picker-btn" id="'+this.sure+'">'+this.sureText+'</div></div><div class="hg-picker-content" id="'+this.content+'"><div class="hg-picker-up-shadow"></div><div class="hg-picker-down-shadow"></div><div class="hg-picker-line"></div></div></div>';for(var a=0;a<this.ulCount;a++)this.renderUl(a),this.paraIndex[a]=0,this.curDis[a]=0*this.liHeight,this.bindRoll(a);this.setStyle();this.setUlWidth()},setStyle:function(){if(this.style){var a=this.style,b=d(this.container),c=d(this.content),h=d(this.box),g=d(this.sure),l=d(this.abolish),e=c.children.length;if(40!==a.liHeight){for(var k=0;k<this.ulCount;k++)f(c.children[k],"height",this.liHeight+"px");c.children[e-3].style.height=2*this.liHeight+"px";c.children[e-2].style.height=2*this.liHeight+"px";c.children[e-1].style.height=this.liHeight+"px";c.children[e-1].style.top=2*this.liHeight+"px";c.style.height=5*this.liHeight+"px";c.style.lineHeight=this.liHeight+"px"}44!==a.btnHeight&&(h.style.height=this.btnHeight+"px",h.style.lineHeight=this.btnHeight+"px");a.btnOffset&&(g.style.marginRight=a.btnOffset,l.style.marginLeft=a.btnOffset);if(40!==a.liHeight||44!==a.btnHeight)b.style.height=5*this.liHeight+this.btnHeight+"px";a.titleColor&&(h.style.color=a.titleColor);a.sureColor&&(g.style.color=a.sureColor);a.cancelColor&&(l.style.color=a.cancelColor);a.btnBgColor&&(h.style.backgroundColor=a.btnBgColor);a.contentColor&&(c.style.color=a.contentColor);a.contentBgColor&&(c.style.backgroundColor=a.contentBgColor);a.upShadowColor&&(c.children[e-3].style.backgroundImage=a.upShadowColor);a.downShadowColor&&(c.children[e-2].style.backgroundImage=a.downShadowColor);a.lineColor&&(c.children[e-1].style.borderColor=a.lineColor)}},renderUl:function(a){var b=d(this.content),c=document.createElement("ul");c.setAttribute("id",this.wrapId+"-ul-"+a);b.insertBefore(c,b.children[b.children.length-3]);this.paraUl[a]=d(this.wrapId+"-ul-"+a);this.renderLi(a)},renderLi:function(a){this.paraUl[a].innerHTML="";var b="<li></li><li></li>";this.getValue(this.data[a]).forEach(function(a,d){b+="<li>"+a+"</li>"});b+="<li></li><li></li>";this.paraUl[a].innerHTML=b;40!==this.liHeight&&f(this.paraUl[a],"height",this.liHeight+"px")},setUlWidth:function(){for(var a=0;a<this.ulCount;a++)this.paraUl[a].style.width=(100/this.ulCount).toFixed(2)+"%"},bindRoll:function(a){var b=this;b.paraUl[a].addEventListener("touchstart",function(){b.touch(a)},!1);b.paraUl[a].addEventListener("touchmove",function(){b.touch(a)},!1);b.paraUl[a].addEventListener("touchend",function(){b.touch(a)},!0)},roll:function(a,b){if(this.curDis[a]||0===this.curDis[a])this.paraUl[a].style.transform="translate3d(0, "+this.curDis[a]+"px, 0)",this.paraUl[a].style.webkitTransform="translate3d(0, "+this.curDis[a]+"px, 0)",b&&(this.paraUl[a].style.transition="transform "+b+"s ease-out",this.paraUl[a].style.webkitTransition="-webkit-transform "+b+"s ease-out")},touch:function(a){var b=b||window.event;b.preventDefault();switch(b.type){case"touchstart":this.startTime=new Date;if(200>this.startTime-this.endTime){this.abled=!1;break}else this.abled=!0;this.startY=b.touches[0].clientY;this.curPos[a]=this.curDis[a];this.moveNumber=1;this.moveSpeed=[];break;case"touchmove":if(!this.abled)break;b.preventDefault();this.moveY=b.touches[0].clientY;b=this.startY-this.moveY;this.curDis[a]=this.curPos[a]-b;this.curDis[a]>=1.5*this.liHeight&&(this.curDis[a]=1.5*this.liHeight);this.curDis[a]<=-1*(this.liNum[a]-1+1.5)*this.liHeight&&(this.curDis[a]=-1*(this.liNum[a]-1+1.5)*this.liHeight);this.roll(a);this.moveTime-this.startTime>=130*this.moveNumber&&(this.moveNumber++,this.moveSpeed.push(b/(this.moveTime-this.startTime)));break;case"touchend":this.abled&&(this.endTime=Date.now(),this.curDis[a]-=this.calculateBuffer(1===this.moveNumber?(this.startY-b.changedTouches[0].clientY)/(this.endTime-this.startTime):this.moveSpeed[this.moveSpeed.length-1],this.a),this.fixate(a))}},calculateBuffer:function(a,b){return.25>Math.abs(a)?0:a/Math.abs(a)*(.5*a*a/b)},fixate:function(a){this.getPosition(a);this.roll(a,.2)},getPosition:function(a){this.paraIndex[a]=this.curDis[a]<=-1*(this.liNum[a]-1)*this.liHeight?this.liNum[a]-1:0<=this.curDis[a]?0:-1*Math.round(this.curDis[a]/this.liHeight);this.curDis[a]=-1*this.liHeight*this.paraIndex[a]},getResult:function(){for(var a=[],b=0;b<this.ulCount;b++)a.push(this.data[b][this.paraIndex[b]]);return a},show:function(a,b){a.classList.add("hg-picker-bg-show");b.classList.add("hg-picker-container-up")},hide:function(a,b){a.classList.remove("hg-picker-bg-show");b.classList.remove("hg-picker-container-up")}};return g});